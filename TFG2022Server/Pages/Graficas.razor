@page "/Graficas"

@using Syncfusion.Blazor.Charts
@inject IVentasPedidoReportService VentasPedidoReportService

<h3>Graficas</h3>

<div class="mt-3">
    <SfChart Title="Ventas Gross / Month">
        <ChartPrimaryXAxis ValueType="Syncfusion.Blazor.Charts.ValueType.Category">
        </ChartPrimaryXAxis>
        <ChartSeriesCollection>
            <ChartSeries DataSource="@TotalVentasPorMes"
                         XName="GroupedFieldKey"
                         YName="Precio"
                         Type="ChartSeriesType.Bar"></ChartSeries>
        </ChartSeriesCollection>
    </SfChart>
</div>

<div class="mt-3">
    <SfAccumulationChart Title="Cantidad / Familia Producto">
        <AccumulationChartLegendSettings Visible="true" Position="LegendPosition.Top"></AccumulationChartLegendSettings>
        <AccumulationChartTooltipSettings Enable="true"></AccumulationChartTooltipSettings>
        <AccumulationChartSeriesCollection>
            <AccumulationChartSeries DataSource="@CantidadProductoPorFamiliaProducto"
                                     XName="GroupedFieldCantidadKey" YName="Cantidad"
                                     Radius="70%" InnerRadius="40%" Name="CantidadPorFamiliaProducto"
                                     Explode="true" ExplodeOffset="10%" ExplodeIndex="3">
                <AccumulationDataLabelSettings Visible="true" Name="Nombre">
                    <AccumulationChartDataLabelFont FontWeight="600" Color="White"></AccumulationChartDataLabelFont>
                </AccumulationDataLabelSettings>
            </AccumulationChartSeries>
        </AccumulationChartSeriesCollection>
    </SfAccumulationChart>
</div>

<div class="mt-3">
    <SfChart Title="Cantidad / Mes">
        <ChartPrimaryXAxis ValueType="Syncfusion.Blazor.Charts.ValueType.Category"></ChartPrimaryXAxis>
        <ChartSeriesCollection>
            <ChartSeries DataSource="@CantidadPorMesData"
                         XName="GroupedFieldCantidadKey" YName="Cantidad" Type="ChartSeriesType.Line"></ChartSeries>
        </ChartSeriesCollection>
    </SfChart>
</div>

@code {
    List<GroupedFieldPrecioModel> TotalVentasPorMes { get; set; }
    List<GroupedFieldCantidadModel> CantidadProductoPorFamiliaProducto { get; set; }
    List<GroupedFieldCantidadModel> CantidadPorMesData { get; set; }

    protected override async Task OnInitializedAsync()
    {
        TotalVentasPorMes = await VentasPedidoReportService.GetUsuarioPrecioPorMesData();
        CantidadProductoPorFamiliaProducto = await VentasPedidoReportService.GetCantidadPorFamiliaProducto();
        CantidadPorMesData = await VentasPedidoReportService.GetCantidadPorMesData();

    }
}
